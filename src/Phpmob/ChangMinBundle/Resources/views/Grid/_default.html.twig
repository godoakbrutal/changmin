{% import '@ChangMin/Macro/messages.html.twig' as messages %}
{% import '@ChangMin/Grid/_table.html.twig' as table %}

{% set definition = grid.definition %}

{% if definition.enabledFilters|length > 0 %}
    {# TODO #}
{% endif %}

{% if grid.data|length > 0 %}
    <table class="table table-sm m-0 scrollable">
        <thead>
        <tr>
            {{ table.headers(grid, definition, app.request.attributes) }}
        </tr>
        </thead>
        <tbody>
        {% for row in grid.data %}
            {{ table.row(grid, definition, row) }}
        {% endfor %}
        </tbody>
    </table>
    <script>
        var $table = $('.table-grid table');
        new TableResize($table.get(0), { restoreState: true, fixed: true });
        // scrollable
        if ($table.hasClass('scrollable')) {
            var colsWidth = $table.find('thead tr:first').children().map(function () {
                return $(this).width();
            }).get();

            $table.find('tbody tr:first').children().each(function (i, v) {
                $(v).width(colsWidth[i]);
            });
        }
    </script>
{% else %}
    {{ messages.info('No results to display') }}
{% endif %}
